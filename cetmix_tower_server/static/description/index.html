<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils: https://docutils.sourceforge.io/" />
<title>Cetmix Tower Server Management</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 8954 2022-01-20 10:10:25Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See https://docutils.sourceforge.io/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="cetmix-tower-server-management">
<h1 class="title">Cetmix Tower Server Management</h1>

<!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! This file is generated by oca-gen-addon-readme !!
!! changes will be overwritten.                   !!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! source digest: sha256:4acc59f24c6a595ffd04cc2b6ed70bfe94541ea16baec84b8591a4c5e29ae09b
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
<p><a class="reference external image-reference" href="https://odoo-community.org/page/development-status"><img alt="Beta" src="https://img.shields.io/badge/maturity-Beta-yellow.png" /></a> <a class="reference external image-reference" href="http://www.gnu.org/licenses/agpl-3.0-standalone.html"><img alt="License: AGPL-3" src="https://img.shields.io/badge/licence-AGPL--3-blue.png" /></a> <a class="reference external image-reference" href="https://github.com/cetmix/cetmix-tower/tree/14.0-dev/cetmix_tower_server"><img alt="cetmix/cetmix-tower" src="https://img.shields.io/badge/github-cetmix%2Fcetmix--tower-lightgray.png?logo=github" /></a></p>
<p>Cetmix Tower offers a streamlined solution for managing remote servers
via SSH directly from Odoo. This module is designed for versatility
across different operating systems and software environments, providing
a practical option for those looking to manage servers without getting
tied down by vendor or technology constraints.</p>
<ul class="simple">
<li><strong>Why Cetmix Tower?</strong><ul>
<li><strong>Open Source:</strong> Cetmix Tower is distributed under the AGPL-3
license.</li>
<li><strong>Flexibility:</strong> Use Cetmix Tower alongside other management
methods without restriction, ensuring you’re not limited to a
single vendor.</li>
<li><strong>Self-Hosting:</strong> Deploy Cetmix Tower on your own infrastructure
for full control over your server management.</li>
<li><strong>Broad Compatibility:</strong> Execute any software that’s manageable
via shell commands, from Docker or Kubernetes to direct OS package
installations.</li>
<li><strong>Odoo Integration:</strong> Benefit from Odoo’s ecosystem for server
management tasks, like deploying servers in response to specific
Odoo-triggered events.</li>
<li><strong>Beyond Odoo:</strong> While optimized for Odoo, Cetmix Tower supports a
wide range of software applications, offering flexibility in
server management tasks.</li>
</ul>
</li>
<li><strong>Connectivity</strong><ul>
<li>Password and key based authentication when connection to remote
server.</li>
<li>Server wide variables that can be used for rendering commands.</li>
</ul>
</li>
<li><strong>Commands</strong><ul>
<li>Execute commands on multiple servers at once.</li>
<li>Render commands using variables.</li>
<li>Store sensitive information in secret keys that are not visible in
command preview.</li>
</ul>
</li>
<li><strong>Flight Plans</strong><ul>
<li>Execute commands in series.</li>
<li>Condition based flow: execute a command based on the previous
command result.</li>
</ul>
</li>
<li><strong>Files</strong><ul>
<li>Download files from remote server using SFTP.</li>
<li>Upload files to remote server using SFTP.</li>
<li>Manage files using templates.</li>
</ul>
</li>
<li><strong>Support and Technical Requirements</strong><ul>
<li>Cetmix Tower is designed to be accessible, though some features
might require a foundational understanding of server management
principles.</li>
<li>We offer dedicated support to help with any custom setup needs or
questions that arise.</li>
<li>For additional details, visit our website
<a class="reference external" href="https://cetmix.com">cetmix.com</a>.</li>
</ul>
</li>
</ul>
<p><strong>Table of contents</strong></p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#configuration" id="toc-entry-1">Configuration</a><ul>
<li><a class="reference internal" href="#configure-a-server" id="toc-entry-2">Configure a Server</a><ul>
<li><a class="reference internal" href="#general-settings" id="toc-entry-3">General Settings</a></li>
<li><a class="reference internal" href="#variables" id="toc-entry-4">Variables</a></li>
<li><a class="reference internal" href="#secrets" id="toc-entry-5">Secrets</a></li>
<li><a class="reference internal" href="#files" id="toc-entry-6">Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configure-variables" id="toc-entry-7">Configure Variables</a><ul>
<li><a class="reference internal" href="#variables-applicability" id="toc-entry-8">Variables Applicability</a></li>
<li><a class="reference internal" href="#variable-types" id="toc-entry-9">Variable Types</a></li>
<li><a class="reference internal" href="#tower-system-variable" id="toc-entry-10">‘tower’ System Variable</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configure-a-key-secret" id="toc-entry-11">Configure a Key/Secret</a></li>
<li><a class="reference internal" href="#configure-a-file" id="toc-entry-12">Configure a File</a><ul>
<li><a class="reference internal" href="#file-templates" id="toc-entry-13">File Templates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configure-a-command" id="toc-entry-14">Configure a Command</a></li>
<li><a class="reference internal" href="#configure-a-flight-plan" id="toc-entry-15">Configure a Flight Plan</a></li>
<li><a class="reference internal" href="#configuration-best-practices" id="toc-entry-16">Configuration best practices</a><ul>
<li><a class="reference internal" href="#use-simple-commands" id="toc-entry-17">Use simple commands</a></li>
<li><a class="reference internal" href="#do-not-change-directory-using-shell-commands" id="toc-entry-18">Do not change directory using shell commands</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="toc-entry-19">Usage</a><ul>
<li><a class="reference internal" href="#running-a-command" id="toc-entry-20">Running a Command</a></li>
<li><a class="reference internal" href="#running-a-flight-plan" id="toc-entry-21">Running a Flight Plan</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bug-tracker" id="toc-entry-22">Bug Tracker</a></li>
<li><a class="reference internal" href="#credits" id="toc-entry-23">Credits</a><ul>
<li><a class="reference internal" href="#authors" id="toc-entry-24">Authors</a></li>
<li><a class="reference internal" href="#maintainers" id="toc-entry-25">Maintainers</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="configuration">
<h1><a class="toc-backref" href="#toc-entry-1">Configuration</a></h1>
<p>Please ensure that you have read and understood the documentation before
running <strong>Cetmix Tower</strong> in the production environment.</p>
<div class="section" id="configure-a-server">
<h2><a class="toc-backref" href="#toc-entry-2">Configure a Server</a></h2>
<p>Go to the <tt class="docutils literal">Cetmix Tower/Servers/Servers</tt> menu and click <tt class="docutils literal">Create</tt>.</p>
<p>Enter the server name and fill the values it the tabs below:</p>
<div class="section" id="general-settings">
<h3><a class="toc-backref" href="#toc-entry-3">General Settings</a></h3>
<ul class="simple">
<li><strong>Partner</strong>: Partner this server belongs to</li>
<li><strong>Operating System</strong>: Operating system that runs on the server</li>
<li><strong>IPv4 Address</strong></li>
<li><strong>IPv6 Address</strong>: Will be used if no IPv4 address is specified</li>
<li><strong>SSH Auth Mode</strong>: Available options are “Password” and “Key”</li>
<li><strong>SSH Port</strong></li>
<li><strong>SSH Username</strong></li>
<li><strong>Use sudo</strong>: If sudo is required by default for running all commands
on this server</li>
<li><strong>SSH Password</strong>: Used if Auth Mode is set to “Password” and for
running <tt class="docutils literal">sudo</tt> commands with password</li>
<li><strong>SSH Private Key</strong>: Used for authentication is SSH Auth Mode is set
to “Key”</li>
<li><strong>Note</strong>: Comments or user notes</li>
</ul>
</div>
<div class="section" id="variables">
<h3><a class="toc-backref" href="#toc-entry-4">Variables</a></h3>
<p>Configure variable values to be used when rendering commands and files
on this server. Check the <a class="reference external" href="#configure-variables">Configuring
Variables</a> section for more details.</p>
</div>
<div class="section" id="secrets">
<h3><a class="toc-backref" href="#toc-entry-5">Secrets</a></h3>
<p>Configure secret values to used when rendering commands and files on
this server. Check the <a class="reference external" href="#configure-a-keysecret">Configuring
Keys/Secrets</a> section for more details.</p>
</div>
<div class="section" id="files">
<h3><a class="toc-backref" href="#toc-entry-6">Files</a></h3>
<p>Click the “Files” action button to access files that belong to this
server. Check the <a class="reference external" href="#configure-a-file">Configuring Files</a> section for
more details.</p>
</div>
</div>
<div class="section" id="configure-variables">
<h2><a class="toc-backref" href="#toc-entry-7">Configure Variables</a></h2>
<p>To configure variables go to the <tt class="docutils literal">Cetmix Tower/Settings</tt> and select
the <tt class="docutils literal">Variables</tt> menu.</p>
<div class="section" id="variables-applicability">
<h3><a class="toc-backref" href="#toc-entry-8">Variables Applicability</a></h3>
<p><strong>Cetmix Tower</strong> supports <tt class="docutils literal">jinja2</tt> syntax for variables. You can use
variables to render:</p>
<ul class="simple">
<li>Commands. Eg <tt class="docutils literal">ls <span class="pre">-lh</span> {{ file_store_location }}</tt></li>
<li>Files. Eg a “Dockerfile” file can have the following text in it:
<tt class="docutils literal">ODOO_VERSION = {{ odoo_default_version }}</tt></li>
<li>File Templates. You can use variables for both file name and file
location on server. Eg <tt class="docutils literal">File Name</tt> value is
<tt class="docutils literal">backup_{{ instance_name }}_{{ odoo_db_name }}</tt> and
<tt class="docutils literal">Directory on server</tt> is <tt class="docutils literal">{{ file_cron_location }}</tt></li>
<li>Other Variables. Eg for an <tt class="docutils literal">odoo_config_location</tt> variable can have
a value of <tt class="docutils literal">{{ <span class="pre">odoo_root}}/conf</span></tt></li>
</ul>
<p>You can use any <tt class="docutils literal">jinja2</tt> supported expressions. For example
<tt class="docutils literal">if else</tt> statements:</p>
<pre class="literal-block">
docker run -d -p {{ odoo_port }}:8069 \
{% if  odoo_longpolling_port and odoo_longpolling_port != '0' and odoo_workers and odoo_workers != '0' %}
    -p {{ odoo_longpolling_port }}:8072 \
{% endif %}
    -v {{ odoo_data }}:/var/lib/odoo \
{% if  odoo_config_location %}
    -v {{ odoo_config_location }}:/etc/odoo \
{% endif %}
</pre>
</div>
<div class="section" id="variable-types">
<h3><a class="toc-backref" href="#toc-entry-9">Variable Types</a></h3>
<p>Following types of variable values available in <strong>Cetmix Tower</strong>:</p>
<ul class="simple">
<li>Local values. Those are values that are defined at a record level.
For example for a server.</li>
<li>Global values. Those are values that are defined at the <strong>Cetmix
Tower</strong> level.</li>
</ul>
<p>When rendering an expression local values are used first. If no local
value is found then global value will be used. For example default value
of the <tt class="docutils literal">odoo_port</tt> variable is <tt class="docutils literal">8069</tt>. However you can easily
specify any other value and thus run multiple Odoo instances on a single
server.</p>
<p><strong>IMPORTANT!</strong>: Storing sensitive data (eg GitHub tokens) in variable
values may expose that date in command preview and logs. Use
<a class="reference external" href="#configure-a-keysecret">secrets</a> for storing such data instead.</p>
</div>
<div class="section" id="tower-system-variable">
<h3><a class="toc-backref" href="#toc-entry-10">‘tower’ System Variable</a></h3>
<p>There is a special <tt class="docutils literal">tower</tt> variable available which allows to access
some system parameters and helper tools. <strong>Important!</strong> do not redefine
the <tt class="docutils literal">tower</tt> variable unless you really need that on purpose.</p>
<p>Following system variables are available:</p>
<ul class="simple">
<li>Server properties<ul>
<li><tt class="docutils literal">tower.server.name</tt> Current server&nbsp;name</li>
<li><tt class="docutils literal">tower.server.username</tt> Current server&nbsp;SSH Username​</li>
<li><tt class="docutils literal">tower.server.ipv4</tt> Current server&nbsp;IPv4 Address​</li>
<li><tt class="docutils literal">tower.server.ipv6</tt> Current server&nbsp;IPv6 Address​</li>
<li><tt class="docutils literal">tower.server.partner_name</tt> Current server partner name</li>
</ul>
</li>
<li>Helper tools<ul>
<li><tt class="docutils literal">tower.tools.uuid</tt> Generates a random UUID4</li>
<li><tt class="docutils literal">tower.tools.today</tt> Current date</li>
<li><tt class="docutils literal">tower.tools.now</tt> Current date time</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="configure-a-key-secret">
<h2><a class="toc-backref" href="#toc-entry-11">Configure a Key/Secret</a></h2>
<div class="line-block">
<div class="line">Keys/Secrets are used to private SSH keys and sensitive data that is
used for rendering command and files.</div>
<div class="line">To configure a new key or secret go to <tt class="docutils literal">Cetmix Tower/Settings/Keys</tt>
click <tt class="docutils literal">Create</tt> and put values in the fields:</div>
</div>
<ul class="simple">
<li><strong>Name</strong>: Readable name</li>
<li><strong>Key Type</strong>: Can be <tt class="docutils literal">SSH Key</tt> or <tt class="docutils literal">Secret</tt></li>
<li><strong>Key ID</strong>: This values will be used for referencing this secret in
commands and files</li>
<li><strong>Value</strong>: Key value. <strong>IMPORTANT:</strong> This is a write only field.
Please ensure that you have saved your key/secret before saving it.
Once saved it cannot be read from the user interface any longer.</li>
<li><strong>Used For</strong>: List of Servers this key of type <tt class="docutils literal">SSH Key</tt> is used
for</li>
</ul>
</div>
<div class="section" id="configure-a-file">
<h2><a class="toc-backref" href="#toc-entry-12">Configure a File</a></h2>
<p><strong>Cetmix Tower</strong> is using SFTP protocol for file transfer operations.
Based on initial file location following file sources are available:</p>
<ul class="simple">
<li>Server. These are files that are initially located on remote server
and are fetched to <strong>Cetmix Tower</strong>. For example log files.</li>
<li>Tower. These are files that are initially formed in <strong>Cetmix Tower</strong>
and are uploaded to remote server. For example configuration files.
Such files are rendered using variables and can be created and
managed using file templates.</li>
</ul>
<p>To create a new file go to <tt class="docutils literal">Cetmix Tower/Files/Files</tt> click <tt class="docutils literal">Create</tt>
and put values in the fields:</p>
<ul class="simple">
<li><strong>Name</strong>: Filesystem filename</li>
<li><strong>Source</strong>: File source. Available options are <tt class="docutils literal">Server</tt> and
<tt class="docutils literal">Tower</tt>. Check above for more details.</li>
<li><strong>Template</strong>: File template used to render this file. If selected
file will be automatically updated every time template is modified.
Used only with <tt class="docutils literal">Tower</tt> source.</li>
<li><strong>Server</strong>: Server where this file is located</li>
<li><strong>Directory on Server</strong>: This is where the file is located on the
remote server</li>
<li><strong>Full Server Path</strong>: Full path to file on the remote server
including filename</li>
<li><strong>Auto Sync</strong>: If enabled the file will be automatically uploaded to
the remote server on after it is modified in <strong>Cetmix Tower</strong>. Used
only with <tt class="docutils literal">Tower</tt> source.</li>
<li><strong>Keep when deleted</strong>: If enabled, file will be kept on remote server
after removing it in the Odoo</li>
</ul>
<p>Following fields are located in the tabs below:</p>
<ul class="simple">
<li><strong>Code</strong>: Raw file content. This field is editable for the <tt class="docutils literal">Tower</tt>
files and readonly for <tt class="docutils literal">Server</tt> ones. This field supports
<a class="reference external" href="#configure-variables">Variables</a>.</li>
<li><strong>Preview</strong>: This is a rendered file content as it will be uploaded
to server. Used only with <tt class="docutils literal">Tower</tt> source.</li>
<li><strong>Server Version</strong>: Current file content fetched from server. Used
only with <tt class="docutils literal">Tower</tt> source.</li>
</ul>
<p><strong>NB</strong>: File operations are performed using user credentials from server
configuration. You should take care of filesystem access rights to
ensure that file operations are performed without any issues.</p>
<div class="section" id="file-templates">
<h3><a class="toc-backref" href="#toc-entry-13">File Templates</a></h3>
<p>File templates are used to create and manage multiple files in bulk.
Once a template is modified all related files are automatically updated.</p>
<p>To create a new file template go to <tt class="docutils literal">Cetmix Tower/Files/Templates</tt>
click <tt class="docutils literal">Create</tt> and put values in the fields:</p>
<ul class="simple">
<li><strong>Name</strong>: Template name</li>
<li><strong>File Name</strong>: Filesystem name of the file(s) created from this
template. This field supports <a class="reference external" href="#configure-variables">Variables</a>.</li>
<li><strong>Directory on server</strong>: Directory on remote server where this file
will be stored. This field supports
<a class="reference external" href="#configure-variables">Variables</a>.</li>
<li><strong>Tags</strong>: Make usage as search more convenient</li>
<li><strong>Note</strong>: Comments or user notes</li>
<li><strong>Code</strong>: Raw file content. This field supports
<a class="reference external" href="#configure-variables">Variables</a>.</li>
<li><strong>Keep when deleted</strong>: If enabled, file(s) created from this template
will be kept on remote server after removing it(them) in the Odoo</li>
</ul>
<p><strong>Hint</strong>: If you want to create a file from template but don’t want
further template modifications to be applied to this file remove the
value from the <tt class="docutils literal">Template</tt> field before saving it.</p>
</div>
</div>
<div class="section" id="configure-a-command">
<h2><a class="toc-backref" href="#toc-entry-14">Configure a Command</a></h2>
<p>Command is a shell command that is executed on remote server. To create
a new command go to <tt class="docutils literal">Cetmix Tower/Commands/Commands</tt> click <tt class="docutils literal">Create</tt>
and put values in the fields:</p>
<ul class="simple">
<li><strong>Name</strong>: Command readable name.</li>
<li><strong>Allow Parallel Run</strong>: If disabled only one copy of this command can
be run on the same server at the same time. Otherwise the same
command can be run in parallel.</li>
<li><strong>Note</strong>: Comments or user notes.</li>
<li><strong>Servers</strong>: List of servers this command can be run on. Leave this
field blank to make the command available to all servers.</li>
<li><strong>OSes</strong>: List of operating systems this command is available. Leave
this field blank to make the command available for all OSes.</li>
<li><strong>Tags</strong>: Make usage as search more convenient.</li>
<li><strong>Action</strong>: Action executed by the command. Possible options:<ul>
<li><tt class="docutils literal">Execute shell command</tt>: Execute a shell command using ssh
connection on remote server.</li>
<li><tt class="docutils literal">Push file</tt>: Create or update a file using selected file
template and push it to remote server. If the file already exists
on server it will be overwritten.</li>
</ul>
</li>
<li><strong>Default Path</strong>: Specify path where command will be executed. This
field supports <a class="reference external" href="#configure-variables">Variables</a>. Important:
ensure ssh user has access to the location even if executing command
using sudo.</li>
<li><strong>Code</strong>: Command code as it will be executed by remote shell. This
field supports <a class="reference external" href="#configure-variables">Variables</a>.</li>
<li><strong>File Template</strong>: File template that will be used to create or
update file. Check <a class="reference external" href="#file-templates">File Templates</a> for more
details.</li>
</ul>
</div>
<div class="section" id="configure-a-flight-plan">
<h2><a class="toc-backref" href="#toc-entry-15">Configure a Flight Plan</a></h2>
<p>Flight Plans are used to execute commands in series. They allow to build
a flexible condition based execution flow. To create a new flight plan
go to <tt class="docutils literal">Cetmix Tower/Commands/Flight Plans</tt> click <tt class="docutils literal">Create</tt> and put
values in the fields:</p>
<ul class="simple">
<li><strong>Name</strong>: Flight Plan name</li>
<li><strong>On Error</strong>: Default action to execute when an error happens during
the flight plan execution. Possible options:<ul>
<li><tt class="docutils literal">Exit with command code</tt>. Will terminate the flight plan
execution and return an exit code of the failed command.</li>
<li><tt class="docutils literal">Exit with custom code</tt>. Will terminate the flight plan
execution and return the custom code configured in the field next
to this one.</li>
<li><tt class="docutils literal">Run next command</tt>. Will continue flight plan execution.</li>
</ul>
</li>
<li><strong>Note</strong>: Comments or user notes.</li>
<li><strong>Servers</strong>: List of servers this command can be run on. Leave this
field blank to make the command available to all servers.</li>
<li><strong>Tags</strong>: Make usage as search more convenient.</li>
<li><strong>Code</strong>: List of commands to execute. Each of the commands has the
following fields:<ul>
<li><strong>Sequence</strong>: Order this command is executed. Lower value = higher
priority.</li>
<li><strong>Command</strong>: <a class="reference external" href="#configure-a-command">Command</a> to be executed.</li>
<li><strong>Path</strong>: Specify path where command will be executed. Overrides
<tt class="docutils literal">Default Path</tt> of the command. This field supports
<a class="reference external" href="#configure-variables">Variables</a>.</li>
<li><strong>Use Sudo</strong>: Use <tt class="docutils literal">sudo</tt> if required to run this command.</li>
<li><strong>Actions</strong>: List of condition based actions to be triggered after
the command is executed. Each of the actions has the following
fields:<ul>
<li><strong>Sequence</strong>: Order this actions is triggered. Lower value =
higher priority.</li>
<li><strong>Condition</strong>: Uses command exit code.</li>
<li><strong>Action</strong>: Action to execute if condition is met. Possible
options:<ul>
<li><tt class="docutils literal">Exit with command code</tt>. Will terminate the flight plan
execution and return an exit code of the failed command.</li>
<li><tt class="docutils literal">Exit with custom code</tt>. Will terminate the flight plan
execution and return the custom code configured in the field
next to this one.</li>
<li><tt class="docutils literal">Run next command</tt>. Will continue flight plan execution.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="configuration-best-practices">
<h2><a class="toc-backref" href="#toc-entry-16">Configuration best practices</a></h2>
<div class="section" id="use-simple-commands">
<h3><a class="toc-backref" href="#toc-entry-17">Use simple commands</a></h3>
<p>Try to avoid using <tt class="docutils literal">&amp;&amp;</tt> or <tt class="docutils literal">;</tt> joined commands unless this is really
needed. Use flight plans instead.</p>
<p><strong>Why?</strong></p>
<ul class="simple">
<li>Simple commands are easier to reuse across multiple flight plans.</li>
<li>Commands run with <tt class="docutils literal">sudo</tt> with password are be split and executed
one by one anyway.</li>
</ul>
<p><strong>Not recommended:</strong></p>
<pre class="code bash literal-block">
apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>upgrade<span class="w"> </span>-y<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>doge-meme-generator
</pre>
<p><strong>Way to go:</strong></p>
<pre class="code bash literal-block">
apt-get<span class="w"> </span>update
</pre>
<pre class="code bash literal-block">
apt-get<span class="w"> </span>upgrade<span class="w"> </span>-y
</pre>
<pre class="code bash literal-block">
apt-get<span class="w"> </span>install<span class="w"> </span>doge-meme-generator
</pre>
</div>
<div class="section" id="do-not-change-directory-using-shell-commands">
<h3><a class="toc-backref" href="#toc-entry-18">Do not change directory using shell commands</a></h3>
<p>Do not use <tt class="docutils literal">cd</tt> or <tt class="docutils literal">chdir</tt> commands. Use <tt class="docutils literal">Default Path</tt> field in
command or <tt class="docutils literal">Path</tt> field in flight plan line.</p>
<p><strong>Why?</strong></p>
<ul class="simple">
<li>Tower will automatically adjust the command to ensure it is properly
executed in the specified location.</li>
</ul>
<p><strong>Do not do this:</strong></p>
<pre class="code bash literal-block">
<span class="nb">cd</span><span class="w"> </span>/home/<span class="o">{{</span><span class="w"> </span>tower.server.username<span class="w"> </span><span class="o">}}</span>/memes<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cat<span class="w"> </span>my_doge_memes.txt
</pre>
<p><strong>Way to go:</strong></p>
<ul class="simple">
<li>Add the following value in the <tt class="docutils literal">Default Path</tt> command field or
<tt class="docutils literal">Path</tt> field of a flight plan line:</li>
</ul>
<pre class="code bash literal-block">
/home/<span class="o">{{</span><span class="w"> </span>tower.server.username<span class="w"> </span><span class="o">}}</span>/memes
</pre>
<ul class="simple">
<li>Leave the command code as follows:</li>
</ul>
<pre class="code bash literal-block">
cat<span class="w"> </span>my_doge_memes.txt
</pre>
</div>
</div>
</div>
<div class="section" id="usage">
<h1><a class="toc-backref" href="#toc-entry-19">Usage</a></h1>
<div class="section" id="running-a-command">
<h2><a class="toc-backref" href="#toc-entry-20">Running a Command</a></h2>
<p>To run a command:</p>
<ul class="simple">
<li>Select a server in the list view or open a server form view</li>
<li>Open the <tt class="docutils literal">Actions</tt> menu and click <tt class="docutils literal">Execute Command</tt></li>
<li>A wizard is opened with the following fields:<ul>
<li><strong>Servers</strong>: Servers on which this command will be executed</li>
<li><strong>Tags</strong>: If selected only commands with these tags will be shown</li>
<li><strong>Sudo</strong>: <tt class="docutils literal">sudo</tt> option for running this command</li>
<li><strong>Command</strong>: Command to execute</li>
<li><strong>Show shared</strong>: By default only commands available for the
selected server(s) are selectable. Activate this checkbox to
select any command</li>
<li><strong>Path</strong>: Directory where command will be executed. Important:
this field does not support variables! Ensure that user has access
to this location even if you run command using sudo.</li>
<li><strong>Code</strong>: Raw command code</li>
<li><strong>Preview</strong>: Command code rendered using server variables.
<strong>IMPORTANT:</strong> If several servers are selected preview will be
rendered for the first one. However during the command execution
command code will be rendered for each server separately.</li>
</ul>
</li>
</ul>
<p>There are two action buttons available in the wizard:</p>
<ul class="simple">
<li><strong>Run</strong>. Executes a command using server “run” method and log command
result into the “Command Log”.</li>
<li><strong>Run in wizard</strong>. Executes a command directly in the wizard and show
command log in a new wizard window.</li>
</ul>
<p>You can check command execution logs in the
<tt class="docutils literal">Cetmix Tower/Commands/Command Logs</tt> menu. Important! If you want to
delete a command you need to delete all its logs manually before doing
that.</p>
</div>
<div class="section" id="running-a-flight-plan">
<h2><a class="toc-backref" href="#toc-entry-21">Running a Flight Plan</a></h2>
<p>To run a flight plan:</p>
<ul>
<li><p class="first">Select a server in the list view or open a server form view</p>
</li>
<li><p class="first">Open the <tt class="docutils literal">Actions</tt> menu and click <tt class="docutils literal">Execute Flight Plan</tt></p>
</li>
<li><p class="first">A wizard is opened with the following fields:</p>
<ul class="simple">
<li><strong>Servers</strong>: Servers on which this command will be executed</li>
<li><strong>Tags</strong>: If selected only commands with these tags will be shown</li>
<li><strong>Plan</strong>: Flight plan to execute</li>
<li><strong>Show shared</strong>: By default only flight plans available for the
selected server(s) are selectable. Activate this checkbox to
select any flight plan</li>
<li><strong>Commands</strong>: Commands that will be executed in this flight plan.
This field is read only</li>
</ul>
<p>Click the <strong>Run</strong> button to execute a flight plan.</p>
<p>You can check the flight plan results in the
<tt class="docutils literal">Cetmix Tower/Commands/Flight Plan Logs</tt> menu. Important! If you
want to delete a command you need to delete all its logs manually
before doing that.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="bug-tracker">
<h1><a class="toc-backref" href="#toc-entry-22">Bug Tracker</a></h1>
<p>Bugs are tracked on <a class="reference external" href="https://github.com/cetmix/cetmix-tower/issues">GitHub Issues</a>.
In case of trouble, please check there if your issue has already been reported.
If you spotted it first, help us to smash it by providing a detailed and welcomed
<a class="reference external" href="https://github.com/cetmix/cetmix-tower/issues/new?body=module:%20cetmix_tower_server%0Aversion:%2014.0-dev%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**">feedback</a>.</p>
<p>Do not contact contributors directly about support or help with technical issues.</p>
</div>
<div class="section" id="credits">
<h1><a class="toc-backref" href="#toc-entry-23">Credits</a></h1>
<div class="section" id="authors">
<h2><a class="toc-backref" href="#toc-entry-24">Authors</a></h2>
<ul class="simple">
<li>Cetmix</li>
</ul>
</div>
<div class="section" id="maintainers">
<h2><a class="toc-backref" href="#toc-entry-25">Maintainers</a></h2>
<p>This module is part of the <a class="reference external" href="https://github.com/cetmix/cetmix-tower/tree/14.0-dev/cetmix_tower_server">cetmix/cetmix-tower</a> project on GitHub.</p>
<p>You are welcome to contribute.</p>
</div>
</div>
</div>
</body>
</html>
