module: cetmix_tower_data_odoo
commands:

  doodba_docker_run:
    name: Doodba - Create / Run container (with odoo_args)
    code: |
      docker run -d \
      -v {{ odoo_conf_data_dir }}:/var/lib/odoo \
      -v {{ odoo_path_config }}:/etc/odoo \
      -v {{ doodba_instance_path }}/odoo/auto/addons:/opt/odoo/auto/addons \
      -v {{ doodba_instance_path }}/odoo/custom/src:/opt/odoo/custom/src \
      --link {{ postgres_instance_name }}:db \
      --name {{ odoo_instance_name }} \
      --restart {{ odoo_restart_policy }} \
      --label "traefik.enable=true" \
      --label "traefik.http.routers.{{ odoo_instance_name }}.rule=Host(\`{{ odoo_website_domain }}\`)" \
      --label "traefik.http.routers.{{ odoo_instance_name }}.tls.certresolver=myresolver" \
      --label "traefik.http.services.{{ odoo_instance_name }}.loadbalancer.server.port=8069" \
      -t {{ odoo_image_name }} {{ odoo_args }}
